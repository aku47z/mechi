---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Card from "../components/Card.astro";
import Button from "../components/Button.astro";
import { Image, getImage } from "astro:assets";
import home1 from "../assets/Homepage/Home 1.jpeg";
import home2 from "../assets/Homepage/Home 2.png";
import home7 from "../assets/Homepage/Home 7.png";
import home6 from "../assets/Homepage/Home 6.png";
import home8 from "../assets/Homepage/Home 8.png";
import home9 from "../assets/Homepage/Home 9.png";
import home10 from "../assets/Homepage/Home 10.jpg";
import LegacyCarousel from "../components/LegacyCarousel.astro";
const hero = await getImage({ src: home1 });
const elevate = await getImage({ src: home10 });
---

<Layout
  title="Mechi Carpets | High Quality Hand-Knotted Tibetan Rugs"
  description="Discover the timeless elegance of Mechi Carpets. Handcrafted Tibetan rugs since 1978, woven with tradition, artistry, and the finest materials. Explore our collection and elevate your space."
>
  <header
    style={`background: linear-gradient(180deg, #191919 -4.4%, rgba(25, 25, 25, 0.5) 25%, rgba(25, 25, 25, 0) 45%), center url('${hero.src}'); background-size: cover;`}
  >
    <Navbar theme="dark" />
    <div id="hero">
      <h1 id="hero-1">For the finest</h1>
      <h1 id="hero-2">
        TIBETAN<br />HANDCRAFTED<br />CARPETS
      </h1>
    </div>
    <h3 id="hero-3">
      With every rug,<br />
      we honor the enduring tradition of Tibetan craftsmanship, preserving its essence
      for generations to come.
    </h3>
  </header>

  <section class="one-two animate-section">
    <div>
      <h2 class="slide-up">LEGACY</h2>
      <p id="legacy-year" class="slide-up">since 1978</p>
    </div>
    <p id="legacy-description" class="slide-up">
      Our legacy is woven into every strand of wool and silk, reflecting a
      commitment to the finest materials, intricate patterns, and rich textures.
      Let us enrich your home with unmatched quality, artistry, and timeless
      elegance.
    </p>
    <div id="legacy-images" class="fade-in">
      <div class="image-wrapper side-image">
        <Image
          src={home2}
          alt="Craftsmanship detail"
          class="responsive-image"
        />
      </div>
      <div class="image-wrapper carousel-image">
        <LegacyCarousel />
      </div>
      <div class="image-wrapper side-image">
        <Image
          src={home6}
          alt="Craftsmanship detail"
          class="responsive-image"
        />
      </div>
    </div>
    <Button link="/product" text="Explore our products" color="#1b1b1c" />
  </section>

  <section class="one-two animate-section" style="background-color: #FFFDFD;">
    <h2 class="slide-up">WHY MECHI<br />SURSHAR CARPETS?</h2>
    <div id="cards" class="fade-in">
      <Card
        image={home7}
        title="Innovative Colors"
        description="With decades of experience in the rug industry and through years of meticulous selection of dyed yarn colors, we are able to provide a host of vibrant in-house colors as well as options for standard ARS1400 color selection box and custom colors. "
      />
      <Card
        image={home8}
        title="Interactive Client Care"
        description="We place much importance to illustrate our client's vision into reality and work to provide the best solutions and service."
      />
      <Card
        image={home9}
        title="Fully Customizable"
        description="Our rugs are fully customizable Incorporating the resilient nature of the traditional Tibetan knotted technique and the supple method of hand tufting."
      />
    </div>
    <Button link="/contact" text="Contact us" color="#1b1b1c" />
  </section>

  <section id="story" class="animate-section">
    <div id="story-title">
      <h2 style="text-align: left;" class="slide-up">
        THE STORY OF OUR HANDMADE RUGS
      </h2>
      <div class="desktop-only">
        <Button link="/about" text="Learn more about us" color="#1b1b1c" />
      </div>
    </div>
    <p id="story-description" class="slide-up">
      The process of creating our hand-knotted Tibetan rugs is meticulous and
      labor-intensive. Using the finest natural materials such as wool and silk,
      each rug is crafted with care and precision. The intricate knots are tied
      one by one, ensuring that every pattern and design tells a unique story.
      With colors inspired by the natural beauty of the Tibetan landscape and
      patterns that reflect cultural symbolism, our rugs are both a work of art
      and a functional treasure.<br />
      <br />
      We are committed to preserving the authenticity and integrity of the Tibetan
      rug-making tradition, supporting local communities, and providing a sustainable
      and ethical source for these exquisite pieces. From the hands of skilled artisans
      to your home, our rugs bring warmth, beauty, and a piece of Tibetan heritage
      into your life. Discover the story woven into every rug, and let one of our
      hand-knotted Tibetan rugs bring timeless elegance to your space.
    </p>
    <div class="mobile-breaks">
      <Button link="/about" text="Learn more about us" color="#1b1b1c" />
    </div>
  </section>

  <section
    id="elevate"
    class="animate-section"
    style={`background: linear-gradient(-7deg, rgba(0, 0, 0, 0.81) -0.57%, rgba(0, 0, 0, 0) 75.89%), center url('${elevate.src}'); background-size: cover;`}
  >
    <h2 id="elevate-text" class="slide-up">
      ELEVATE YOUR SPACE WITH OUR CARPETS
    </h2>
    <Button
      link="/product"
      text="View our collection"
      color="#ffffff"
      class="slide-up"
    />
  </section>
</Layout>

<style>
  header {
    margin-top: -380px;
    padding-top: 380px;
    height: 2280px;
    width: auto;
  }

  #hero {
    margin-top: 65px;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
    color: #fff;
    font-family: "Cormorant Garamond", serif;
    font-style: normal;
    text-align: center;
  }

  #hero-1 {
    font-weight: 300;
    font-size: 2rem;
    line-height: 150%; /* 3rem */
    letter-spacing: -0.06rem;
  }

  #hero-2 {
    font-weight: 300;
    font-size: 6.25rem;
    line-height: 100%; /* 5.75rem */
    letter-spacing: -0.2875rem;
  }

  #hero-3 {
    border-radius: 50%;
    margin-top: 600px;
    margin-left: auto;
    margin-right: auto;
    background: radial-gradient(rgba(0, 0, 0, 0.5) 10%, rgba(0, 0, 0, 0) 85%);
    padding: 2rem;
    width: 60rem;
    color: #fff;
    line-height: 100%; /* 3rem */
    letter-spacing: -0.06rem;
    text-align: center;
  }

  .one-two {
    padding-top: 3.75rem;
    padding-bottom: 5.75rem;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    gap: 3.6rem;
  }

  #cards {
    max-width: min-content;
    margin: 0 auto;
    display: flex;
    justify-content: flex-start;
  }

  #legacy-year {
    color: #1b1b1c;
    font-family: "General Sans", sans-serif;
    font-size: 1.5rem;
    font-style: normal;
    font-weight: 300;
    line-height: 160%;
    letter-spacing: 0.0075rem;
  }

  #legacy-description {
    max-width: 68rem;
  }

  #legacy-images {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-evenly;
    gap: 1rem;
  }

  .image-wrapper {
    flex-shrink: 1;
  }

  /* Side items take less space */
  .side-image {
    flex: 1 1 22.5%;
    max-width: 22.5%;
    min-width: 180px;
  }

  /* Carousel in the middle takes more space */
  .carousel-image {
    flex: 1 1 30%;
    max-width: 30%;
    min-width: 200px;
  }

  .responsive-image {
    display: block;
    width: 100%;
    height: auto;
    object-fit: cover;
  }

  #story {
    padding: 7.8125rem 9.375rem 9.5rem 2.5rem;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
  }

  .desktop-only {
    display: block;
  }

  #story-title {
    min-width: 40rem;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 2rem;
  }

  #story-description {
    max-width: 41.5rem;
  }

  #elevate {
    margin-bottom: -10px;
    height: 808px;
    width: auto;
    display: flex;
    flex-direction: column;
    gap: 2rem;
    justify-content: flex-end;
    align-items: center;
    padding-bottom: 125px;
  }

  #elevate-text {
    color: white;
    max-width: 45rem;
  }

  /* Refined animation styles */
  .slide-up,
  .fade-in {
    opacity: 0;
    transition-duration: 1s;
    transition-property: opacity, transform;
    transition-timing-function: cubic-bezier(0.33, 1, 0.68, 1);
    will-change: opacity, transform;
  }

  .slide-up {
    transform: translateY(30px);
  }

  .slide-up.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .fade-in.visible {
    opacity: 1;
  }

  /* Animation for cards to stagger in */
  #cards .card {
    opacity: 0;
    transform: translateY(20px);
    transition:
      opacity 0.8s cubic-bezier(0.33, 1, 0.68, 1),
      transform 0.8s cubic-bezier(0.33, 1, 0.68, 1);
  }

  #cards.visible .card {
    opacity: 1;
    transform: translateY(0);
  }

  /* Animation for legacy images to come in smoothly */
  #legacy-images .image-wrapper {
    opacity: 0;
    transform: translateY(15px);
    transition:
      opacity 0.7s cubic-bezier(0.33, 1, 0.68, 1),
      transform 0.7s cubic-bezier(0.33, 1, 0.68, 1);
  }

  #legacy-images.visible .image-wrapper {
    opacity: 1;
    transform: translateY(0);
  }

  @media screen and (max-width: 1280px) {
    #story {
      flex-direction: column;
      gap: 2rem;
    }

    #story-description {
      max-width: 100%;
    }
  }

  @media screen and (max-width: 768px) {
    #hero-2 {
      font-size: 4.5rem;
      line-height: 100%; /* 4.5rem */
      letter-spacing: -0.2rem;
    }
    #hero-3 {
      max-width: fit-content;
    }

    .one-two {
      padding: 3.75rem 0rem;
      gap: 2.25rem;
    }

    #legacy-description {
      max-width: 80%;
    }

    #legacy-images {
      overflow-x: hidden;
      justify-content: center;
    }

    .side-image {
      flex: 1 1 20%;
      max-width: 20%;
      min-width: 110px;
    }

    .carousel-image {
      flex: 1 1 20%;
      max-width: 20%;
      min-width: 180px;
    }

    #cards {
      overflow-x: scroll;
      scroll-behavior: smooth;
      max-width: 90vw;
    }

    #story {
      padding: 3.75rem 3rem;
      gap: 1rem;
    }

    #story-title {
      min-width: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      gap: 1rem;
    }

    #story-description {
      max-width: 100vw;
    }

    #elevate {
      height: 768px;
      padding-bottom: 120px;
      gap: 0.5rem;
      justify-content: flex-end;
    }
  }

  @media screen and (max-width: 480px) {
    header {
      margin-top: -50px;
      padding-top: 50px;
      height: 750px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }

    #hero {
      margin-top: 20px;
      gap: 0.25rem;
    }

    #hero-1 {
      background: radial-gradient(rgba(0, 0, 0, 0.3) 10%, rgba(0, 0, 0, 0) 70%);
      border-radius: 50%;
      font-size: 1.25rem;
      letter-spacing: -0.0375rem;
    }

    #hero-2 {
      background: radial-gradient(rgba(0, 0, 0, 0.3) 20%, rgba(0, 0, 0, 0) 80%);
      border-radius: 50%;
      font-size: 2rem;
      letter-spacing: -0.1rem;
    }

    #hero-3 {
      background: radial-gradient(rgba(0, 0, 0, 0.5) 10%, rgba(0, 0, 0, 0) 70%);
      padding-top: 7rem;
      max-width: 19rem;
      margin-top: auto;
      margin-bottom: auto;
      font-size: 1.25rem;
      letter-spacing: -0.025rem;
    }

    #elevate {
      padding: 2rem 1rem;
      margin-bottom: 0;
      height: 330px;
    }

    #elevate-text {
      max-width: 90%;
    }

    .desktop-only {
      display: none;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Progressive animation triggering for regular sections
    const animateSections = document.querySelectorAll(".animate-section");

    // Observer for sections
    const sectionObserver = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            const section = entry.target;

            // Get all animatable elements in this section
            const elements = section.querySelectorAll(".slide-up, .fade-in");

            // Animate elements with a slight staggered delay
            elements.forEach((el, index) => {
              setTimeout(() => {
                el.classList.add("visible");
              }, index * 120); // Stagger each element by 120ms
            });

            // Stop observing once triggered
            sectionObserver.unobserve(section);
          }
        });
      },
      {
        root: null,
        threshold: 0.2, // Start when section is 20% visible
        rootMargin: "0px 0px -10% 0px",
      }
    );

    // Observe all sections
    animateSections.forEach((section) => sectionObserver.observe(section));

    // Special handling for card animations
    const cardsContainer = document.getElementById("cards");
    if (cardsContainer) {
      const cards = cardsContainer.querySelectorAll(".card");

      const cardsObserver = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              // Add visible class to container
              cardsContainer.classList.add("visible");

              // Stagger individual cards
              cards.forEach((card, index) => {
                card.style.transitionDelay = `${index * 180}ms`;
              });

              cardsObserver.unobserve(cardsContainer);
            }
          });
        },
        {
          threshold: 0.2,
          rootMargin: "0px 0px -10% 0px",
        }
      );

      cardsObserver.observe(cardsContainer);
    }

    // Special handling for legacy images
    const legacyImages = document.getElementById("legacy-images");
    if (legacyImages) {
      const images = legacyImages.querySelectorAll(".image-wrapper");

      const imagesObserver = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              // Add visible class to container
              legacyImages.classList.add("visible");

              // Stagger individual images
              images.forEach((img, index) => {
                img.style.transitionDelay = `${index * 150}ms`;
              });

              imagesObserver.unobserve(legacyImages);
            }
          });
        },
        {
          threshold: 0.2,
          rootMargin: "0px 0px -10% 0px",
        }
      );

      imagesObserver.observe(legacyImages);
    }
  });
</script>
